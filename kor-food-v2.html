<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>인터랙티브 한식 백과사전 (안정화 버전)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; scroll-behavior: smooth; }
        .map-korea { position: relative; width: 100%; max-width: 500px; margin: auto; }
        .map-korea .province { position: absolute; cursor: pointer; transition: all 0.3s ease; }
        .map-korea .province:hover .province-shape { transform: scale(1.1); fill-opacity: 0.8; }
        .map-korea .province.active .province-shape { fill-opacity: 1; stroke-width: 4px; }
        .province-shape { transition: all 0.3s ease; stroke: #fff; stroke-width: 2px; }
        .modal { transition: opacity 0.3s ease; }
        .modal-content { transition: transform 0.3s ease; }
        .chart-container { position: relative; width: 100%; max-width: 800px; margin-left: auto; margin-right: auto; height: 350px; max-height: 400px; }
        .status-tag { font-size: 0.7rem; font-weight: bold; padding: 2px 6px; border-radius: 9999px; margin-left: 8px; }
        .guide-tab-btn.active { border-color: #0891b2; color: #0e7490; font-weight: 600; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <header class="bg-white/90 backdrop-blur-lg shadow-sm sticky top-0 z-40">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <h1 class="text-2xl md:text-3xl font-bold text-slate-900 tracking-tight">인터랙티브 한식 백과사전</h1>
            <p class="text-sm md:text-base text-slate-600 mt-1">한식 분류 체계의 누락된 지점을 탐험하고 숨겨진 요리를 재발견합니다.</p>
        </div>
    </header>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8">

        <section id="explorer-hub" class="mb-12">
            <h2 class="text-2xl font-bold text-center mb-8">한식 탐험 허브: 테마별로 숨겨진 요리 발견하기</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div id="hub-guide" class="hub-card col-span-1 md:col-span-2 lg:col-span-3 bg-cyan-600 text-white p-6 rounded-2xl shadow-lg cursor-pointer hover:shadow-xl hover:bg-cyan-700 transition-all duration-300">
                    <h3 class="text-xl font-bold mb-2">📖 분류 체계 안내</h3>
                    <p>새로운 요리를 어떤 기준으로 분류하는지, 각 분류의 정의와 판단 기준을 확인해보세요.</p>
                </div>
                <div id="hub-regional" class="hub-card bg-white p-6 rounded-2xl shadow-lg cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                    <h3 class="text-xl font-bold text-green-700 mb-2">🗺️ 향토음식</h3>
                    <p class="text-slate-600">지도 위에서 각 지역의 기후와 특산물이 빚어낸 고유의 맛을 발견해보세요.</p>
                </div>
                <div id="hub-royal" class="hub-card bg-white p-6 rounded-2xl shadow-lg cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                    <h3 class="text-xl font-bold text-amber-700 mb-2">🏛️ 궁중음식</h3>
                    <p class="text-slate-600">격식과 체계가 담긴 왕실의 식문화를 탐험합니다.</p>
                </div>
                <div id="hub-temple" class="hub-card bg-white p-6 rounded-2xl shadow-lg cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                    <h3 class="text-xl font-bold text-teal-700 mb-2">🧘 사찰음식</h3>
                    <p class="text-slate-600">자연의 순리와 수행의 철학이 담긴 세계로 안내합니다.</p>
                </div>
                <div id="hub-north" class="hub-card bg-white p-6 rounded-2xl shadow-lg cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                    <h3 class="text-xl font-bold text-blue-700 mb-2">🕊️ 이북음식</h3>
                    <p class="text-slate-600">분단의 역사와 실향의 이야기를 품은 북녘의 맛을 만나보세요.</p>
                </div>
                <div id="hub-modern" class="hub-card bg-white p-6 rounded-2xl shadow-lg cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                    <h3 class="text-xl font-bold text-purple-700 mb-2">✨ 현대/퓨전 한식</h3>
                    <p class="text-slate-600">끊임없이 진화하는 한식의 최신 트렌드를 소개합니다.</p>
                </div>
                 <div id="hub-omission" class="hub-card bg-white p-6 rounded-2xl shadow-lg cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                    <h3 class="text-xl font-bold text-rose-700 mb-2">📊 누락의 이유</h3>
                    <p class="text-slate-600">왜 어떤 요리들은 목록에서 사라졌을까요? 그 구조적 원인을 데이터로 분석합니다.</p>
                </div>
            </div>
        </section>

        <div id="content-display" class="mt-12"></div>

        <section id="master-list" class="mt-12 bg-white p-6 rounded-2xl shadow-lg">
             <h2 class="text-2xl font-bold text-center mb-8">한식 요리 종합 목록 (총 <span id="food-count">0</span>개)</h2>
             <div class="flex flex-wrap gap-4 mb-6 justify-center">
                 <div class="w-full sm:w-auto">
                    <label for="filter-category" class="block text-sm font-medium text-slate-700">대분류 (유형별)</label>
                    <select id="filter-category" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-cyan-500 focus:border-cyan-500 sm:text-sm rounded-md">
                        <option value="all">전체</option>
                    </select>
                </div>
                <div class="w-full sm:w-auto">
                    <label for="search-food" class="block text-sm font-medium text-slate-700">음식 이름 검색</label>
                    <input type="text" id="search-food" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-cyan-500 focus:border-cyan-500 sm:text-sm" placeholder="예: 갱시기, 갈비탕...">
                </div>
             </div>
             <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-200">
                    <thead class="bg-slate-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">대분류</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">소분류</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">음식명</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">유래/맥락</th>
                        </tr>
                    </thead>
                    <tbody id="master-table-body" class="bg-white divide-y divide-slate-200">
                    </tbody>
                </table>
             </div>
        </section>
    </main>
    
    <div id="food-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4 opacity-0 pointer-events-none modal">
        <div id="modal-content" class="modal-content bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto transform scale-95">
        </div>
    </div>


    <footer class="bg-slate-800 text-white mt-16">
        <div class="container mx-auto p-6 text-center text-sm text-slate-400">
            <p>본 콘텐츠는 '한식 분류 체계의 종합적 검증 및 보완' 보고서를 기반으로 제작된 인터랙티브 애플리케이션입니다.</p>
            <p class="mt-1">&copy; 2025 Interactive Korean Food Encyclopedia.</p>
        </div>
    </footer>
    
    <script>
        // --- DATA INITIALIZATION (STABLE) ---
        const allFoodData = {};

        function initializeData() {
            const standardFoods = {
                "1. 밥류 (Bap-ryu)": { "비빔밥·덮밥·죽류": ["가지덮밥", "갈비찜덮밥", "김치덮밥", "꼬막비빔밥", "꽃비빔밥", "낙지덮밥", "나물비빔밥", "날치알비빔밥", "닭죽", "대창덮밥", "덮밥", "돼지고기덮밥", "돌솥비빔밥", "돈가스덮밥", "마파두부덮밥", "멍게비빔밥", "미음", "버섯덮밥", "버섯채소덮밥", "불고기쌈밥", "불오징어덮밥", "비빔밥", "산채비빔밥", "삼겹살덮밥", "새싹비빔밥", "새우그라탕덮밥", "생선구이쌈밥", "소고기비빔밥", "소고기야채죽", "순두부새우덮밥", "스팸덮밥", "스팸마요덮밥", "쌈밥", "알밥", "애호박덮밥", "양배추볶음밥", "양파계란덮밥", "양파채덮밥", "어항가지덮밥", "오이나물비빔밥", "오징어덮밥", "우렁쌈밥", "유산슬덮밥", "육회비빔밥", "잡채밥", "전주비빔밥", "제육덮밥", "제육쌈밥", "중화비빔밥", "진주비빔밥", "짜장밥", "짬뽕밥", "참치김치덮밥", "참치비빔밥", "치밥", "치킨마요덮밥", "카레라이스", "콩나물비빔밥", "해주비빔밥", "헛제삿밥", "회덮밥"], "볶음밥·김밥·주먹밥류": ["간장어묵김밥", "계란김밥", "계란말이김밥", "구운주먹밥", "김밥", "김치김밥", "김치볶음밥", "꼬마김밥", "누드김밥", "달걀볶음밥", "땡초김밥", "마약김밥", "밀밥", "묵은지참치김밥", "밥버거", "볶음밥", "불고기김밥", "불어묵김밥", "삼각김밥", "삼선볶음밥", "새우볶음밥", "소고기김밥", "스팸김밥", "스팸무스비", "주먹밥", "중국집볶음밥", "참치김밥", "크래미김밥", "해물김치볶음밥"], "기본밥·영양밥류": ["가지밥", "감자밥", "강황밥", "고구마밥", "고두밥", "고봉밥", "곤드레밥", "곤약밥", "공깃밥", "귀리밥", "누룽지", "단호박밥", "당근밥", "대통밥", "대추밥", "메밀밥", "밤밥", "백반", "보리밥", "비지밥", "비닐밥", "쌀밥", "약밥(약식)", "연잎밥", "영양밥", "오곡밥", "옥수수밥", "완두콩밥", "율무밥", "은행밥", "인삼밥", "자굴밥", "자미밥", "찰밥", "클로렐라밥", "콩나물밥", "콩밥", "팥밥", "피밥", "해초밥", "현미밥", "호밀밥", "홍미밥", "흑두밥", "흑미밥"] },
                "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)": { "국밥류": ["굴국밥", "국밥", "돼지국밥", "소머리국밥", "수구레국밥", "순대국밥", "우거지국밥", "콩나물국밥", "평양온반", "따로국밥"], "찌개류": ["갈치찌개", "고추장찌개", "김치찌개", "된장찌개", "동태찌개", "막장찌개", "부대찌개", "비지찌개", "새우젓찌개", "순두부찌개", "전찌개", "짜글이", "청국장찌개"], "탕류": ["갈낙탕", "갈비탕", "감자탕", "곰탕", "꽃게탕", "닭개장", "닭곰탕", "닭도리탕(닭볶음탕)", "닭한마리", "대구탕", "도가니탕", "매운탕", "뼈다귀해장국", "사골국", "삼계탕", "설렁탕", "아귀탕", "알탕", "어묵탕", "어탕", "오리탕", "용봉탕", "우거지탕", "육개장", "조개탕", "초계탕", "추어탕", "해물탕", "해장국", "홍합탕"], "국류": ["감자국", "계란국", "고사릿국", "된장국", "떡국", "떡만둣국", "만둣국", "매생이국", "묵국", "미역국", "북어국(황태국)", "선짓국", "소고기무국", "시래기국", "아욱국", "오징어무국", "재첩국", "콩나물국", "콩국", "토란국"], "전골·냉국류": ["곱창전골", "불고기전골", "신선로", "가지냉국", "더덕냉국", "미역냉국", "오이냉국", "콩나물냉국"] },
                "3. 구이류 (Gui-ryu)": { "육류 구이": ["LA갈비", "갈비구이", "곱창구이", "너비아니", "닭불고기", "돼지갈비구이", "돼지불고기", "막창구이", "맥적", "목살구이", "불고기", "삼겹살구이", "소갈비구이", "소금구이(방자구이)", "오징어불고기", "전기구이 통닭", "제육구이"], "해산물 구이": ["갈치구이", "고등어구이", "꼼장어구이", "꽁치구이", "북어구이", "생선구이", "장어구이", "조개구이", "조기양념구이"], "채소·산적류": ["가지구이", "더덕구이", "버섯구이", "누름적", "산적", "섭산적"] },
                "4. 찜·조림류 (Jjim·Jorim-ryu)": { "찜류": ["가래떡찜", "가지찜", "갈비찜", "계란찜", "단호박찜", "닭찜 (안동찜닭)", "도미찜", "돼지고기찜", "두부새우젓찜", "민어찜", "배추말이찜", "북어찜", "아귀찜", "양배추찜", "오징어찜", "전복찜", "코다리찜", "해물찜", "호박된장찜", "홍어찜"], "조림류": ["가자미조림", "갈치조림", "감자조림", "고등어조림", "꽁치조림", "깻잎조림", "꼬막조림", "닭고기감자조림", "땅콩조림", "멸치조림", "명태조림", "무조림", "알감자조림", "연근조림", "우엉조림", "은대구조림", "장조림", "전복초", "조기조림"] },
                "5. 볶음류 (Bokkeum-ryu)": { "육류·해물 볶음": ["고추잡채", "낙지볶음", "닭갈비", "돼지고기김치볶음", "오삼불고기", "오징어볶음", "제육볶음", "순대볶음"], "채소·기타 볶음": ["가지볶음", "감자채볶음", "마늘쫑볶음", "멸치볶음", "미역줄기볶음", "버섯볶음", "소시지야채볶음", "애호박볶음", "어묵볶음", "오징어채볶음(진미채볶음)", "콩나물볶음"], "떡볶이·잡채류": ["떡볶이", "월과채", "잡채"] },
                "6. 나물·생채·무침류 (Namul·Saengchae·Muchim-ryu)": { "숙채 (익힌 나물)": ["가지나물", "고구마순나물", "고사리나물", "냉이무침", "도라지나물", "무나물", "미나리나물", "방풍나물무침", "부추무침", "숙주나물", "씀바귀나물", "시금치나물", "우엉나물", "유채나물", "취나물", "콩나물무침"], "생채 (생 나물)": ["달래무침", "더덕무침", "도라지생채", "돌나물무침", "무생채", "미역오이초무침", "오이무침", "파채무침"], "기타 무침": ["김무침", "깻잎무침", "꼬막무침", "참나물무침", "청포묵무침", "해파리냉채", "황태채무침", "봄동겉절이", "상추겉절이"] },
                "7. 전·튀김류 (Jeon·Twigim-ryu)": { "전·부침개류": ["감자전", "고추전", "굴전", "김치전", "깻잎전", "꼬치전(산적꼬치)", "녹두전(빈대떡)", "대구전", "도토리묵전", "동그랑땡(완자전)", "동태전", "두부전", "메밀전", "메밀전병", "민어전", "배추전", "버섯전", "부추전", "생선전(전유어)", "애호박전", "어묵전", "연근전", "오징어전", "옥수수전", "육전", "장떡", "참치전", "파전(해물파전, 동래파전)", "표고전"], "튀김류": ["가지튀김", "고구마튀김", "고추튀김", "김말이", "닭튀김", "냉이튀김", "새우튀김", "오징어튀김", "야채튀김"], "부각·튀각류": ["가죽나물부각", "감자부각", "고추부각(고추튀각)", "김부각(김튀각)", "다시마부각(다시마튀각)", "두릅부각", "들깨송이부각", "미역부각", "쑥부각", "황태껍질부각"] },
                "8. 면류 (Myeon-ryu)": { "온면": ["건진국수", "닭칼국수", "라면", "생선국수", "잔치국수", "칼국수"], "냉면": ["김치말이국수", "꿩메밀국수", "냉면 (물냉면)", "막국수", "밀면", "콩국수"], "비빔면": ["냉면 (비빔냉면)", "비빔국수", "쟁반국수", "쫄면", "콩나물비빔국수", "해물볶음국수"], "수제비·기타": ["감자수제비", "콧등치기국수", "수제비", "올챙이국수"], "중화풍 면류": ["짜장면", "짬뽕"] },
                "9. 만두류 (Mandu-ryu)": { "만두": ["감자만두", "고기만두", "군만두(튀김만두)", "김치만두", "꿩만두", "메밀만두", "물만두", "산적만두", "쌈만두", "생치만두", "어만두", "찐만두", "편수", "해물만두"] },
                "10. 김치류 (Kimchi-ryu)": { "김치": ["갓김치", "개성보쌈김치", "겉절이", "고구마줄기김치", "고들빼기김치", "깻잎김치", "깍두기", "나박김치", "더덕김치", "동치미", "무비늘김치", "물김치", "박김치", "배추김치", "백김치", "보쌈김치", "부추김치", "섞박지", "순무김치", "양하김치", "열무김치", "오이소박이", "장김치", "총각김치", "파김치", "파래김치", "호박김치", "홍어김치"] },
                "11. 젓갈·장아찌류 (Jeotgal·Jangajji-ryu)": { "젓갈류": ["가자미식해", "간장게장", "갈치속젓", "갈치젓", "게우젓", "굴젓(어리굴젓)", "까나리액젓", "꼴뚜기젓", "대구알젓", "대합젓", "멸치젓", "명란젓", "밴댕이젓", "병어젓", "새우젓", "서거리젓", "성게알젓", "식해", "양념게장", "어란", "오징어젓", "자리젓", "조개젓", "창난젓", "토하젓", "황석어젓"], "장아찌류": ["가지장아찌", "감장아찌", "고추장아찌", "고추잎장아찌", "깻잎장아찌", "마늘장아찌", "매실장아찌", "무장아찌", "양파장아찌", "오이장아찌", "우엉장아찌", "참외장아찌"] },
                "12. 떡·한과류 (Tteok·Hangwa-ryu)": { "떡류": ["가래떡", "감자떡", "개피떡", "경단", "꿀떡", "기정떡(증편)", "단자", "무지개떡", "바람떡", "백설기", "부편", "송편", "수수부꾸미", "쑥떡", "시루떡", "오메기떡", "인절미", "절편", "주악", "찰떡", "화전"], "한과류": ["강정", "다식", "매작과", "산자", "약과", "양갱", "엿", "엿강정", "유과", "율란", "정과", "조란", "호두과자"] }
            };
            
            const researchedFoods = {
                '초교탕': { origin: '향토음식', subCategory: '수도권', description: "닭고기, 미나리, 도라지, 버섯 등을 넣고 맑게 끓인 탕. 궁중음식의 영향을 받은 고급 요리.", reason: "설렁탕, 닭한마리 등 대중적인 탕류에 비해 인지도가 낮아 일반 목록에서 자주 누락됨.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '우메기떡': { origin: '향토음식', subCategory: '수도권 (개성)', description: "찹쌀가루를 막걸리로 반죽하여 빚어 기름에 지진 후 조청이나 꿀에 집청한 떡. 개성주악이라고도 불림.", reason: "조리법이 복잡하고 고급 한과로 분류되어 일상적인 향토음식 목록에서는 제외되는 경향.", category: "12. 떡·한과류 (Tteok·Hangwa-ryu)" },
                '젓국갈비': { origin: '향토음식', subCategory: '수도권 (강화)', description: "돼지갈비에 새우젓으로 간을 하고 두부, 채소 등을 넣어 끓인 맑은 탕.", reason: "강화도라는 특정 지역에 한정된 음식으로, 수도권 전체를 아우르는 목록에서는 누락되기 쉬움.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '즘떡': { origin: '향토음식', subCategory: '수도권 (연천)', description: "찹쌀가루에 팥, 콩, 밤, 대추 등을 섞어 시루에 찐 떡.", reason: "특정 지역의 의례나 명절에 주로 만들어 먹는 음식으로, 보편성이 낮아 기록에서 누락.", category: "12. 떡·한과류 (Tteok·Hangwa-ryu)" },
                '병어감정': { origin: '향토음식', subCategory: '수도권', description: "병어를 고추장과 된장으로 양념하여 자작하게 조린 음식.", reason: "'감정'이라는 조리법 자체가 현대에는 생소하며, 조기나 갈치조림에 비해 덜 알려져 있음.", category: "4. 찜·조림류 (Jjim·Jorim-ryu)" },
                '방풍죽': { origin: '향토음식', subCategory: '강원도 (강릉)', description: "해안가에서 자라는 방풍나물을 넣어 끓인 죽. 독특한 향이 특징.", reason: "약용 식재료를 활용한 건강식으로, 일반적인 식사 메뉴보다는 별식으로 취급되어 누락.", category: "1. 밥류 (Bap-ryu)" },
                '서거리깍두기': { origin: '향토음식', subCategory: '강원도', description: "명태의 아가미, 내장 등을 무와 함께 버무려 담근 깍두기.", reason: "'서거리'라는 방언과 명태의 특수 부위를 사용해 일반인에게 생소하고, 지역성이 매우 강함.", category: "10. 김치류 (Kimchi-ryu)" },
                '삼숙이탕': { origin: '향토음식', subCategory: '강원도', description: "못생긴 생선인 삼세기(삼숙이)를 넣어 얼큰하게 끓인 탕.", reason: "주재료인 삼숙이가 전국적으로 유통되지 않는 지역 어종이라 인지도가 극히 낮음.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '도치두루치기': { origin: '향토음식', subCategory: '강원도', description: "겨울철 별미인 도치를 묵은지와 함께 볶거나 끓여내는 요리.", reason: "계절성이 강하고 '도치'라는 생선 자체가 대중적이지 않아 향토 별미로만 알려져 있음.", category: "5. 볶음류 (Bokkeum-ryu)" },
                '지누아리장아찌': { origin: '향토음식', subCategory: '강원도', description: "'지누아리'라는 홍조류 해초로 담근 장아찌.", reason: "특정 해조류를 이용한 저장음식으로, 식재료의 희소성과 낮은 보편성으로 인해 기록에서 누락.", category: "11. 젓갈·장아찌류 (Jeotgal·Jangajji-ryu)" },
                '미역생떡국': { origin: '향토음식', subCategory: '충청도', description: "쌀가루로 떡을 만들어 미역국에 넣어 끓인 음식.", reason: "일반적인 떡국(소고기 육수)과 다른 독특한 조합으로, 지역적 별미로만 소비되어 보편성이 낮음.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '호박청': { origin: '향토음식', subCategory: '충청도', description: "늙은 호박을 푹 고아서 만든, 잼이나 차의 형태로 즐기는 음식.", reason: "주식이나 반찬이 아닌 '청' 형태의 가공식품으로, 요리 목록에서는 종종 제외됨.", category: "11. 젓갈·장아찌류 (Jeotgal·Jangajji-ryu)" },
                '도리뱅뱅이': { origin: '향토음식', subCategory: '충청도 (옥천)', description: "피라미 등 작은 민물고기를 팬에 동그랗게 돌려 담아 양념에 조린 음식.", reason: "민물고기를 주재료로 하여 호불호가 갈리며, 특정 지역(옥천 등)의 별미로 한정됨.", category: "4. 찜·조림류 (Jjim·Jorim-ryu)" },
                '느티떡': { origin: '향토음식', subCategory: '충청도 (아산)', description: "멥쌀가루에 느티나무의 어린 순을 섞어 찐 떡.", reason: "특정 계절의 특정 식물 부위를 사용하는 등 재료의 특수성과 지역성으로 인해 널리 알려지지 않음.", category: "12. 떡·한과류 (Tteok·Hangwa-ryu)" },
                '박속낙지탕': { origin: '향토음식', subCategory: '충청도 (서산, 태안)', description: "박을 넣은 맑은 국물에 산낙지를 데쳐 먹는 탕.", reason: "연포탕과 유사하지만 '박'을 사용하는 지역적 특색이 있으며, 서해안 일부 지역의 향토음식으로 인지됨.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '애호박찌개': { origin: '향토음식', subCategory: '전라도 (광주)', description: "돼지고기와 애호박을 넉넉히 넣고 고추장, 고춧가루로 얼큰하게 끓인 찌개.", reason: "'국밥' 형태로도 불리며, 광주 지역의 대표적인 서민 음식이지만 다른 유명 음식에 가려져 있음.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '상추튀김': { origin: '향토음식', subCategory: '전라도 (광주)', description: "오징어튀김 등 각종 튀김을 간장 양념과 함께 상추에 싸 먹는 독특한 분식.", reason: "'튀김'이라는 이름과 달리 '쌈'의 형태로 먹는 방식이 독특하여, 음식 분류가 모호해 누락되기 쉬움.", category: "7. 전·튀김류 (Jeon·Twigim-ryu)" },
                '짱뚱어탕': { origin: '향토음식', subCategory: '전라도 (순천, 벌교)', description: "갯벌에서 나는 짱뚱어를 삶아 갈아서 시래기 등과 함께 끓인 탕.", reason: "추어탕과 유사하지만 짱뚱어라는 특이 어종을 사용하며, 남해안 일부 지역의 보양식으로 알려짐.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '닭회': { origin: '향토음식', subCategory: '전라도', description: "신선한 닭의 가슴살이나 모래집 등을 날것으로 먹는 요리.", reason: "식재료의 극도의 신선도가 요구되고 식중독 위험이 있어 보편화되지 못한, 극히 일부 지역의 별미.", category: "6. 나물·생채·무침류 (Namul·Saengchae·Muchim-ryu)" },
                '설탕국수': { origin: '향토음식', subCategory: '전라도', description: "삶은 소면에 찬물이나 보리차를 붓고 설탕만으로 간을 해 먹는 여름 국수.", reason: "조리법이 극도로 단순하고 가정식의 성격이 강해, 공식적인 요리 목록에 포함되지 않는 경우가 많음.", category: "8. 면류 (Myeon-ryu)" },
                '고갈비': { origin: '향토음식', subCategory: '경상도 (부산)', description: "고등어를 연탄불 등에 구워 양념장을 발라내는 요리. '고등어 갈비'라는 별칭으로 불림.", reason: "특정 시대(70-80년대)의 선술집 문화를 배경으로 한 음식으로, 현대적인 목록에서는 누락될 수 있음.", category: "3. 구이류 (Gui-ryu)" },
                '갱시기': { origin: '향토음식', subCategory: '경상도', description: "신김치, 콩나물, 찬밥, 국수 등을 넣고 함께 끓인 음식. 죽과 국의 중간 형태.", reason: "'꿀꿀이죽'과 비슷하게 보일 수 있는 서민적이고 소박한 가정식으로, 정식 요리로 취급되지 않는 경향.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '모리국수': { origin: '향토음식', subCategory: '경상도 (포항)', description: "아귀 등 각종 해산물과 콩나물을 넣고 고춧가루로 얼큰하게 끓여내는 국수.", reason: "지역성이 매우 강하고 비주얼이 투박함.", category: "8. 면류 (Myeon-ryu)" },
                '돔배기': { origin: '향토음식', subCategory: '경상도', description: "상어고기를 토막 내어 소금에 절인 것. 주로 찜이나 산적으로 조리하여 제사상에 올림.", reason: "제사 음식이라는 특수성과 상어고기라는 희소한 식재료 때문에 일상적인 음식 목록에서는 제외됨.", category: "4. 찜·조림류 (Jjim·Jorim-ryu)" },
                '빼때기죽': { origin: '향토음식', subCategory: '경상도 (통영)', description: "말린 고구마(빼때기)와 팥, 강낭콩 등을 넣고 끓인 달콤한 죽.", reason: "구황작물로 만들던 시절의 음식이라는 역사적 배경이 있으며, 주식보다는 별식으로 여겨짐.", category: "1. 밥류 (Bap-ryu)" },
                '접짝뼈국': { origin: '향토음식', subCategory: '제주도', description: "돼지의 '접짝뼈'를 푹 고아 무, 두부를 넣고 메밀가루로 농도를 맞춘 국. 제주 잔칫 음식.", reason: "방언과 특수 부위 사용으로 인해 접근성이 낮고, 몸국, 고사리육개장에 비해 덜 알려짐.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '각재기국': { origin: '향토음식', subCategory: '제주도', description: "전갱이(각재기)를 통째로 넣고 배추, 된장을 풀어 시원하게 끓인 국.", reason: "등푸른 생선을 국으로 끓이는 방식이 육지에서는 흔치 않으며, '각재기'라는 방언이 생소함.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                '쉰다리': { origin: '향토음식', subCategory: '제주도', description: "찬밥과 누룩을 발효시켜 만든 제주 전통 음료.", reason: "현대에는 거의 만들어 먹지 않는, 사라져가는 전통 음식으로 기록에서조차 찾기 어려움.", category: "12. 떡·한과류 (Tteok·Hangwa-ryu)" },
                '보말칼국수': { origin: '향토음식', subCategory: '제주도', description: "제주 바다에서 나는 고둥(보말)을 까서 내장과 함께 끓여낸 칼국수.", reason: "'보말'이라는 식재료가 제주 특산물이며, 내장을 함께 사용해 진한 녹색을 띠는 등 외형이 독특함.", category: "8. 면류 (Myeon-ryu)" },
                '빙떡': { origin: '향토음식', subCategory: '제주도', description: "메밀 반죽을 얇게 부친 전에 삶은 무채를 소로 넣고 돌돌 만 떡. 담백하고 슴슴한 맛이 특징.", reason: "자극적인 맛에 익숙한 현대인의 입맛에는 심심하게 느껴져 대중화에 한계.", category: "12. 떡·한과류 (Tteok·Hangwa-ryu)" },
                '몸국': { origin: '향토음식', subCategory: '제주도', description: "돼지고기와 내장, 뼈를 푹 삶은 국물에 해조류 '모자반(몸)'을 넣고 끓인 제주의 대표적인 잔치 음식.", reason: "제주 특유의 잔치 문화와 식재료에 기반하여 육지에서는 생소하고 맛의 호불호가 갈릴 수 있음.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)"},
                '초조반': { origin: '궁중음식', subCategory: '상차림', description: "임금이 이른 새벽에 받는 보양식 죽상. 계절에 따라 잣죽, 타락죽, 장국죽 등 다양한 죽이 올랐다.", reason: "단품 요리가 아닌 '상차림' 개념으로, 일반적인 요리 목록에서는 통째로 누락되는 경우가 많음.", category: "1. 밥류 (Bap-ryu)" },
                '두텁떡': { origin: '궁중음식', subCategory: '병과류', description: "거피팥고물을 묻힌 떡 안에 꿀, 잣, 대추 등을 소로 넣고 찐 고급 떡.", reason: "조리법이 매우 복잡하고 전문 기술을 요하여 현대에는 쉽게 접하기 어려움.", category: "12. 떡·한과류 (Tteok·Hangwa-ryu)" },
                '어선': { origin: '궁중음식', subCategory: '단품 요리', description: "민어나 도미의 살을 얇게 떠서 채소, 버섯 등과 함께 찐 생선찜 요리.", reason: "신선로, 구절판 등 상징적인 요리에 비해 인지도가 낮아 누락됨.", category: "4. 찜·조림류 (Jjim·Jorim-ryu)" },
                '승기아탕': { origin: '궁중음식', subCategory: '단품 요리', description: "생선, 고기, 채소 등 귀한 재료를 전으로 부쳐 전골틀에 담고 왜된장을 푼 국물에 끓여먹는 호사스러운 전골.", reason: "조리법이 매우 복잡하고 호화로워 일반적인 궁중요리 목록에서도 쉽게 찾아보기 어려움.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)"},
                '규아상': { origin: '궁중음식', subCategory: '단품 요리', description: "오이, 다진 고기, 표고버섯을 소로 넣고 해삼 모양으로 빚은 여름 만두.", reason: "정교한 모양과 계절성으로 인해 대중화되지 못한 궁중 별미.", category: "9. 만두류 (Mandu-ryu)"},
                '연저육': { origin: '궁중음식', subCategory: '단품 요리', description: "부드러운 어린 돼지고기를 통째로 쪄낸 요리. 연하고 부드러운 식감이 특징.", reason: "재료의 특수성과 정교한 조리법으로 인해 잘 알려지지 않음.", category: "4. 찜·조림류 (Jjim·Jorim-ryu)"},
                '발우공양 코스': { origin: '사찰음식', subCategory: '상차림', description: "술적심, 죽상, 상미, 담미, 유미, 입가심으로 이어지는 사찰의 단계별 식사 코스.", reason: "개별 요리가 아닌 식사 과정 전체의 구조와 철학이 담겨있어 일반 목록에서는 누락됨.", category: "사찰음식" },
                '모듬버섯강정': { origin: '사찰음식', subCategory: '별식', description: "여러 종류의 버섯을 튀겨 달콤한 조청 소스에 버무린 요리.", reason: "전통 사찰음식을 현대적으로 재해석한 창의적인 요리로, 아직 널리 알려지지 않음.", category: "7. 전·튀김류 (Jeon·Twigim-ryu)" },
                '상추불뚝김치': { origin: '사찰음식', subCategory: '김치류', description: "상추를 소금에 절이지 않고 바로 양념에 버무려 먹는 즉석 김치.", reason: "오신채를 사용하지 않는 독특한 조리법이 일반 김치와 달라 목록에서 누락.", category: "10. 김치류 (Kimchi-ryu)" },
                '오이잣물김치': { origin: '사찰음식', subCategory: '김치류', description: "오이를 잣을 갈아 만든 국물에 담근 고급 물김치.", reason: "잣을 사용한 독특하고 고급스러운 조리법으로 인해 대중적이지 않음.", category: "10. 김치류 (Kimchi-ryu)"},
                '두부장쌈장': { origin: '사찰음식', subCategory: '양념류', description: "으깬 두부와 된장, 견과류 등을 섞어 만든 사찰식 쌈장.", reason: "양념류로 분류되어 단품 요리 목록에서는 자주 누락됨.", category: "11. 젓갈·장아찌류 (Jeotgal·Jangajji-ryu)"},
                '인조고기밥': { origin: '이북음식', subCategory: '사회적 맥락', description: "콩기름 짠 찌꺼기로 만든 인조고기에 밥을 넣고 양념장을 바른 음식.", reason: "음식 자체보다 탄생 배경의 사회적, 역사적 맥락이 중요하며, 남한에서는 생소한 길거리 음식.", category: "1. 밥류 (Bap-ryu)" },
                '두부밥': { origin: '이북음식', subCategory: '사회적 맥락', description: "삼각형으로 썬 튀긴 두부 사이에 밥을 넣고 양념장을 얹어 먹는 북한의 대표 길거리 음식.", reason: "인조고기밥과 함께 북한 서민 문화를 대표하지만, 남한에서는 잘 알려져있지 않음.", category: "1. 밥류 (Bap-ryu)"},
                '가릿국': { origin: '이북음식', subCategory: '비인기 요리', description: "소갈비로 낸 국물에 밥을 말고, 편육과 함께 육회, 선지를 고명으로 올리는 함경도식 장국밥.", reason: "육회와 선지를 고명으로 올리는 독특한 방식이 남한에서는 생소함.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)"},
                '노티': { origin: '이북음식', subCategory: '비인기 요리', description: "찹쌀가루를 엿기름으로 발효시켜 기름에 지져 만든 평안도 지방의 저장떡.", reason: "발효 과정을 거치는 독특한 제법과 지역성으로 인해 널리 알려지지 않음.", category: "12. 떡·한과류 (Tteok·Hangwa-ryu)" },
                '언감자떡': { origin: '이북음식', subCategory: '비인기 요리', description: "겨울에 얼린 감자를 녹여 만든 전분으로 빚은 함경도 떡.", reason: "감자를 얼리는 특수한 가공 과정이 필요하고, 함경도라는 지역성에 한정됨.", category: "12. 떡·한과류 (Tteok·Hangwa-ryu)"},
                '어복쟁반': { origin: '이북음식', subCategory: '비인기 요리', description: "얇게 썬 소 편육과 채소를 놋쟁반에 둘러 담아 육수를 부어가며 끓여먹는 평양식 전골 요리.", reason: "평양냉면에 비해 대중성이 낮고, 여러 명이 함께 먹는 고급 요리로 인식됨.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)"},
                '연안식해': { origin: '이북음식', subCategory: '황해도', description: "황해도 연안 지방의 가자미 식해.", reason: "가자미식해가 함경도 음식으로 널리 알려져 있어 황해도 버전은 상대적으로 덜 알려짐.", category: "11. 젓갈·장아찌류 (Jeotgal·Jangajji-ryu)"},
                '뉴웨이브 국밥': { origin: '현대/퓨전', subCategory: '최신 트렌드', description: "전통 국밥을 고급 식재료와 현대적 플레이팅, 스토리텔링으로 재해석한 돼지곰탕 등.", reason: "단일 메뉴가 아닌 '트렌드'로서, 한식의 진화를 보여주는 중요한 현상.", category: "2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)" },
                'K-전통간식': { origin: '현대/퓨전', subCategory: '최신 트렌드', description: "약과 위에 크림을 올리거나, 라즈베리 맛 양갱 등 전통 간식의 현대적 변용.", reason: "'할매니얼', '뉴트로' 트렌드를 반영하는 현상.", category: "12. 떡·한과류 (Tteok·Hangwa-ryu)" },
                '뇨끼 떡볶이': { origin: '현대/퓨전', subCategory: '글로벌 하이브리드', description: "이탈리아의 뇨끼와 한국의 떡볶이를 결합하여 식감의 장벽을 낮춘 퓨전 요리.", reason: "한식의 세계화를 위한 현지화 전략을 보여주는 창의적인 시도.", category: "5. 볶음류 (Bokkeum-ryu)" },
                '새우장 부라타': { origin: '현대/퓨전', subCategory: '글로벌 하이브리드', description: "짭조름한 간장새우장과 신선한 이탈리아 부라타 치즈의 조합.", reason: "동서양의 발효와 신선의 조화를 보여주는 파인 다이닝의 혁신적 메뉴.", category: "6. 나물·생채·무침류 (Namul·Saengchae·Muchim-ryu)" },
                '돌문어 간장국수': { origin: '현대/퓨전', subCategory: '글로벌 하이브리드', description: "신선한 돌문어 숙회를 간장 베이스의 소스에 비벼 먹는 프리미엄 면 요리.", reason: "전통 재료를 현대적 플레이팅과 세련된 맛으로 풀어냄.", category: "8. 면류 (Myeon-ryu)"},
            };
            
            for (const name in researchedFoods) {
                allFoodData[name] = { ...researchedFoods[name], status: 'researched' };
            }

            for (const category in standardFoods) {
                for (const subCategory in standardFoods[category]) {
                    standardFoods[category][subCategory].forEach(name => {
                        if (!allFoodData[name]) {
                            allFoodData[name] = { category: category, subCategory: subCategory, origin: '일반 한식', description: `한국의 대중적인 ${category.split(' ')[1]} 요리입니다.`, reason: '-', status: 'standard' };
                        }
                    });
                }
            }
        }
        
        // --- UI RENDER AND EVENT LISTENERS ---
        document.addEventListener('DOMContentLoaded', () => {
            initializeData();
            
            const hubCards = document.querySelectorAll('.hub-card');
            const contentDisplay = document.getElementById('content-display');
            const modal = document.getElementById('food-modal');
            const modalContent = document.getElementById('modal-content');
            const masterTableBody = document.getElementById('master-table-body');
            const categoryFilter = document.getElementById('filter-category');
            const searchInput = document.getElementById('search-food');
            const foodCountEl = document.getElementById('food-count');
            const definitions = {
                categories: [
                    { name: '1. 밥류 (Bap-ryu)', desc: '쌀을 주재료로 하여 지은 밥을 중심으로 한 모든 요리. 죽, 덮밥, 비빔밥, 김밥, 볶음밥 등 다양한 형태를 포함합니다.' },
                    { name: '2. 국·탕·찌개류 (Guk·Tang·Jjigae-ryu)', desc: '국물이 있는 요리. 국(일상적, 맑음), 탕(건더기 중심, 고급), 찌개(짜고 걸쭉함, 반찬), 전골(즉석 조리)로 나뉩니다.' },
                    { name: '3. 구이류 (Gui-ryu)', desc: '재료를 직화나 팬에 직접 구워내는 요리. 양념 유무, 재료(육류, 해산물, 채소)에 따라 분류됩니다.' },
                    { name: '4. 찜·조림류 (Jjim·Jorim-ryu)', desc: '찜(증기로 익힘)과 조림(양념에 졸임) 두 가지 조리법을 포함. 재료의 원형을 살리면서 맛을 깊게 배게 하는 것이 특징입니다.' },
                    { name: '5. 볶음류 (Bokkeum-ryu)', desc: '기름을 두른 팬에 재료를 빠르게 볶아내는 요리. 주재료와 양념에 따라 분류됩니다.' },
                    { name: '6. 나물·생채·무침류 (Namul·Saengchae·Muchim-ryu)', desc: '채소를 주재료로 양념하여 만드는 요리. 익힌 것은 숙채(나물), 날것은 생채, 다양한 재료를 섞으면 무침으로 분류됩니다.' },
                    { name: '7. 전·튀김류 (Jeon·Twigim-ryu)', desc: '기름을 이용한 요리. 얇게 부치면 전, 깊은 기름에 튀기면 튀김, 재료를 말려 튀기면 부각/튀각으로 나뉩니다.' },
                    { name: '8. 면류 (Myeon-ryu)', desc: '면을 주재료로 하는 모든 요리. 국물의 유무와 온도, 조리법에 따라 분류됩니다.' },
                    { name: '9. 만두류 (Mandu-ryu)', desc: '다진 재료를 소로 하여 얇은 피로 감싼 요리. 익히는 방식(찜, 튀김, 삶음)과 소의 종류에 따라 나뉩니다.' },
                    { name: '10. 김치류 (Kimchi-ryu)', desc: '채소를 소금에 절여 발효시킨 한국의 대표적인 저장 음식. 주재료와 국물 유무에 따라 분류됩니다.' },
                    { name: '11. 젓갈·장아찌류 (Jeotgal·Jangajji-ryu)', desc: '발효를 이용한 저장 음식. 해산물을 소금에 삭히면 젓갈, 채소 등을 장이나 식초에 절이면 장아찌로 분류됩니다.' },
                    { name: '12. 떡·한과류 (Tteok·Hangwa-ryu)', desc: '곡물 가루를 쪄서 만드는 떡과, 곡물/과일/식물 뿌리 등을 이용해 만든 전통 과자인 한과를 포함합니다.' },
                    { name: '13. 현대/퓨전 한식', desc: '전통 한식의 범주를 넘어, 외래의 조리법이나 식재료와 결합하거나 현대적 트렌드에 맞춰 재해석된 모든 요리를 포함합니다.' }
                ],
                origins: [
                    { name: '일반 한식', desc: '특정 유래/맥락에 속하지 않고, 전국적으로 널리 알려져 표준적인 조리법이 존재하는 대중적인 한식입니다.', criteria: '아래의 특정 유래/맥락 분류에 해당하지 않는 대부분의 요리가 포함됩니다.' },
                    { name: '향토음식', desc: '특정 지역의 기후, 지리적 조건, 특산물을 기반으로 형성된 고유한 식문화가 담긴 요리입니다.', criteria: '그 지역이 아니면 맛보기 어렵거나, 특정 지역과 강하게 연관되어 있습니까?' },
                    { name: '궁중음식', desc: '조선시대 궁궐에서 왕과 왕족을 위해 정교한 격식과 최고의 기술로 만들어진 요리입니다.', criteria: '조리법이 매우 정교하고, 격식있는 상차림의 일부입니까?' },
                    { name: '사찰음식', desc: '사찰에서 불교의 계율에 따라 오신채(파, 마늘, 달래, 부추, 흥거)를 사용하지 않고 만든 채식 요리입니다.', criteria: '오신채를 사용하지 않으며, 제철 채소를 중심으로 한 채식 요리입니까?' },
                    { name: '이북음식', desc: '분단 이전 북쪽 지방(황해도, 평안도, 함경도)의 식문화가 담긴 요리로, 실향의 역사나 현지에서의 변용 과정을 포함합니다.', criteria: '분단 이전 북한 지역에서 유래했거나, 그 지역의 서사를 담고 있습니까?' },
                    { name: '현대/퓨전', desc: '전통 조리법에 외래 식재료나 조리법이 결합되었거나, 현대의 식문화 트렌드에 맞게 재창조된 요리입니다.', criteria: '전통 한식의 범주를 넘어서는 새로운 시도나 재해석이 포함되어 있습니까?' }
                ]
            };

            function openModal(foodName) {
                const data = allFoodData[foodName];
                if (!data) return;
                let modalHtml = `<div class="p-6 md:p-8"><div class="flex justify-between items-start"><h3 class="text-2xl font-bold text-slate-900 mb-2">${foodName}</h3><button id="close-modal" class="text-slate-500 hover:text-slate-800 text-2xl">&times;</button></div><div class="text-sm font-medium text-white inline-block px-3 py-1 rounded-full mb-4" style="background-color: ${getOriginColor(data.origin)}">${data.origin}${data.origin !== '일반 한식' ? ` > ${data.subCategory}`: ''}</div><p class="text-slate-700 leading-relaxed mb-4">${data.description}</p>`;
                if (data.status === 'researched') {
                    modalHtml += `<div class="bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg"><h4 class="font-semibold text-amber-800">📋 누락 분석</h4><p class="text-amber-700 text-sm mt-1">${data.reason}</p></div>`;
                }
                modalHtml += `</div>`;
                modalContent.innerHTML = modalHtml;
                modal.classList.remove('opacity-0', 'pointer-events-none');
                modalContent.classList.remove('scale-95');
                document.getElementById('close-modal').addEventListener('click', closeModal);
            }

            function closeModal() {
                modal.classList.add('opacity-0', 'pointer-events-none');
                modalContent.classList.add('scale-95');
            }

            function getOriginColor(origin) {
                switch(origin) {
                    case '향토음식': return '#16a34a'; case '궁중음식': return '#d97706'; case '사찰음식': return '#0d9488'; case '이북음식': return '#2563eb'; case '현대/퓨전': return '#9333ea'; default: return '#475569';
                }
            }
            
            function renderContent(type) {
                let content = '';
                contentDisplay.scrollIntoView({ behavior: 'smooth', block: 'start' });
                const researchedFoods = Object.keys(allFoodData).filter(key => allFoodData[key].status === 'researched').reduce((obj, key) => { obj[key] = allFoodData[key]; return obj; }, {});

                switch(type) {
                    case 'hub-guide':
                        content = `<div class="bg-white p-6 rounded-2xl shadow-lg"><h3 class="text-2xl font-bold text-cyan-700 mb-4 text-center">📖 한식 분류 체계 안내</h3><div class="border-b border-slate-200 mb-6 flex justify-center"><button class="guide-tab-btn py-2 px-4 border-b-2 active" data-tab="guide-origin">유래/맥락 기준</button><button class="guide-tab-btn py-2 px-4 border-b-2 border-transparent" data-tab="guide-category">대분류(요리 유형) 기준</button></div><div id="guide-tab-content"></div></div>`;
                        break;
                    case 'hub-regional':
                         content = `<div class="bg-white p-6 rounded-2xl shadow-lg"><h3 class="text-2xl font-bold text-green-700 mb-4 text-center">🗺️ 향토음식 탐험</h3><p class="text-center text-slate-600 mb-6">지도에서 지역을 선택하여 숨겨진 향토음식을 확인해보세요.</p><div class="flex flex-col md:flex-row gap-8 items-center"><div class="w-full md:w-1/2"><div class="map-korea"><svg viewBox="0 0 500 600" id="korea-map-svg"><g class="province" data-region="수도권"><path class="province-shape fill-green-200 hover:fill-green-400" d="M222 170 l-40 -60 l-30 0 l-25 30 l0 30 l30 25 l25 25 l40 -50z M210 115 l-10 10 l-15 0 l-10 -10 l0 -10 l10 -10 l15 0 l10 10z" /><text x="175" y="140" class="font-bold text-sm fill-slate-700 pointer-events-none">경기</text></g><g class="province" data-region="강원도"><path class="province-shape fill-green-200 hover:fill-green-400" d="M222 170 l40 -50 l50 -50 l70 0 l20 90 l-50 70 l-90 0z" /><text x="290" y="130" class="font-bold text-sm fill-slate-700 pointer-events-none">강원</text></g><g class="province" data-region="충청도"><path class="province-shape fill-green-200 hover:fill-green-400" d="M222 170 l-70 15 l-30 40 l130 50 l-20 -60 l-70 -10z" /><text x="200" y="225" class="font-bold text-sm fill-slate-700 pointer-events-none">충청</text></g><g class="province" data-region="경상도"><path class="province-shape fill-green-200 hover:fill-green-400" d="M262 310 l150 -150 l20 120 l-100 50 l-10 90 l-120 20z" /><text x="345" y="250" class="font-bold text-sm fill-slate-700 pointer-events-none">경북</text><text x="295" y="340" class="font-bold text-sm fill-slate-700 pointer-events-none">경남</text></g><g class="province" data-region="전라도"><path class="province-shape fill-green-200 hover:fill-green-400" d="M152 280 l70 60 l-30 50 l-70 -40z M122 350 l110 50 l-50 60 l-100 -40z" /><text x="155" y="360" class="font-bold text-sm fill-slate-700 pointer-events-none">전라</text></g><g class="province" data-region="제주도"><path class="province-shape fill-green-200 hover:fill-green-400" d="M130 500 l80 0 l20 30 l-120 -10z" /><text x="165" y="525" class="font-bold text-sm fill-slate-700 pointer-events-none">제주</text></g></svg></div></div><div id="regional-info" class="w-full md:w-1/2 p-4 bg-green-50 rounded-lg min-h-[300px]"><p class="text-slate-500">지도를 클릭하여 지역별 정보를 확인하세요.</p></div></div></div>`;
                        break;
                    case 'hub-omission':
                        content = `<div class="bg-white p-6 rounded-2xl shadow-lg"><h3 class="text-2xl font-bold text-rose-700 mb-4 text-center">📊 왜 요리는 누락되는가?</h3><p class="text-center text-slate-600 mb-8">특정 요리들이 목록에서 사라지는 구조적 원인을 분석한 결과입니다.</p><div class="chart-container"><canvas id="omission-chart"></canvas></div></div>`;
                        break;
                    default: 
                        // For Royal, Temple, North, Modern hubs
                        contentDisplay.innerHTML = '';
                        return; // Return to avoid overwriting later
                }
                contentDisplay.innerHTML = content;
                
                if (type === 'hub-guide') renderGuideTabContent('guide-origin');
                if (type === 'hub-regional') addMapListeners(researchedFoods);
                if (type === 'hub-omission') renderOmissionChart();
                addFoodItemListeners();
            }

            function renderGuideTabContent(tab) {
                 const contentDiv = document.getElementById('guide-tab-content');
                 if (!contentDiv) return;
                 const tabButtons = document.querySelectorAll('.guide-tab-btn');
                 tabButtons.forEach(btn => {
                     btn.classList.remove('active');
                     if(btn.dataset.tab === tab) btn.classList.add('active');
                 });

                 let html = '<div class="space-y-4">';
                 if (tab === 'guide-category') {
                     definitions.categories.forEach(item => {
                         html += `<div class="p-4 bg-slate-50 rounded-lg"><h4 class="font-bold text-slate-800">${item.name.split(' ')[1]}</h4><p class="text-sm text-slate-600 mt-1">${item.desc}</p></div>`;
                     });
                 } else {
                     definitions.origins.forEach(item => {
                         html += `<div class="p-4 bg-slate-50 rounded-lg"><h4 class="font-bold" style="color:${getOriginColor(item.name)}">${item.name}</h4><p class="text-sm text-slate-600 mt-1">${item.desc}</p><div class="mt-2 text-xs bg-cyan-50 text-cyan-800 p-2 rounded"><b>판단 기준:</b> ${item.criteria}</div></div>`;
                     });
                 }
                 html += '</div>';
                 contentDiv.innerHTML = html;
                 addGuideTabListeners();
            }
            
            function addGuideTabListeners() {
                document.querySelectorAll('.guide-tab-btn').forEach(btn => {
                    btn.addEventListener('click', () => renderGuideTabContent(btn.dataset.tab));
                });
            }

            function renderOmissionChart() {
                const ctx = document.getElementById('omission-chart')?.getContext('2d');
                if(!ctx) return;
                new Chart(ctx, { type: 'bar', data: { labels: ['과도한 지역성', '식재료 희소성/비대중성', '맥락의 탈각', '빠른 진화 속도', '역사적/계급적 편향'], datasets: [{ label: '누락 원인별 요리 수 (추정)', data: [18, 12, 6, 6, 4], backgroundColor: 'rgba(225, 29, 72, 0.6)', borderColor: 'rgba(225, 29, 72, 1)', borderWidth: 1 }] }, options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, title: { display: true, text: '주요 누락 원인 분석' } }, scales: { x: { beginAtZero: true } } } });
            }

            function addMapListeners(data) {
                const provinces = document.querySelectorAll('.province');
                const infoDiv = document.getElementById('regional-info');
                provinces.forEach(p => {
                    p.addEventListener('click', () => {
                        provinces.forEach(el => el.classList.remove('active')); p.classList.add('active');
                        const regionName = p.dataset.region;
                        const regionFoods = Object.keys(data).filter(key => { const item = data[key]; if(item.origin !== '향토음식') return false; if(regionName === '수도권') return item.subCategory.includes('수도권'); return item.subCategory.includes(regionName); });
                        let infoHtml = `<h4 class="font-bold text-lg text-green-800 mb-3">${regionName}의 숨겨진 요리</h4>`;
                        if (regionFoods.length > 0) {
                            infoHtml += '<ul class="space-y-2">'; regionFoods.forEach(food => { infoHtml += `<li><button class="food-item text-left text-slate-700 hover:text-green-600 transition" data-food="${food}">${food}</button></li>`; }); infoHtml += '</ul>';
                        } else { infoHtml += '<p class="text-slate-500">이 지역의 누락된 정보가 아직 없습니다.</p>'; }
                        infoDiv.innerHTML = infoHtml; addFoodItemListeners();
                    });
                });
            }

            function addFoodItemListeners() {
                document.querySelectorAll('.food-item').forEach(item => { item.addEventListener('click', (e) => { const foodName = e.currentTarget.dataset.food; openModal(foodName); }); });
            }
            
            function populateFilters() {
                 const categories = new Set(Object.values(allFoodData).map(item => item.category));
                 definitions.categories.forEach(def => {
                    if(categories.has(def.name)) {
                         const option = document.createElement('option'); option.value = def.name; option.textContent = def.name.split(' (')[0]; categoryFilter.appendChild(option);
                    }
                 });
            }

            function populateMasterList() {
                const category = categoryFilter.value; const searchTerm = searchInput.value.toLowerCase();
                let filteredHtml = ''; let count = 0;
                Object.keys(allFoodData).sort().forEach(key => {
                    const item = allFoodData[key];
                    const matchesCategory = (category === 'all' || item.category === category);
                    const matchesSearch = (searchTerm === '' || key.toLowerCase().includes(searchTerm));
                    if (matchesCategory && matchesSearch) {
                        count++;
                        filteredHtml += `<tr class="hover:bg-slate-50"><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900">${item.category.split(' ')[1]}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-500">${item.subCategory}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-semibold text-cyan-700"><button class="food-item hover:underline" data-food="${key}">${key}</button>${item.status === 'researched' ? '<span class="status-tag bg-rose-100 text-rose-800">신규/연구</span>' : ''}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium" style="color:${getOriginColor(item.origin)}">${item.origin}</td></tr>`;
                    }
                });
                masterTableBody.innerHTML = filteredHtml; foodCountEl.textContent = count;
                addFoodItemListeners();
            }

            hubCards.forEach(card => { card.addEventListener('click', () => { renderContent(card.id); }); });
            modal.addEventListener('click', (e) => { if (e.target === modal) { closeModal(); } });
            categoryFilter.addEventListener('change', populateMasterList);
            searchInput.addEventListener('input', populateMasterList);

            populateFilters();
            populateMasterList();
        });
    </script>
</body>
</html>
